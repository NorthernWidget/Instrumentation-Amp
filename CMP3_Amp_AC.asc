Version 4
SHEET 1 1656 680
WIRE 480 -32 368 -32
WIRE 592 -32 544 -32
WIRE 144 16 112 16
WIRE 592 16 592 -32
WIRE 688 16 672 16
WIRE 720 16 688 16
WIRE 832 16 800 16
WIRE 832 32 832 16
WIRE -112 48 -112 16
WIRE 688 48 688 16
WIRE 688 48 480 48
WIRE 528 80 528 64
WIRE 96 96 96 80
WIRE 480 96 480 48
WIRE 496 96 480 96
WIRE 32 112 32 16
WIRE 32 112 -48 112
WIRE 64 112 32 112
WIRE 592 112 592 16
WIRE 592 112 560 112
WIRE 608 112 592 112
WIRE 672 112 608 112
WIRE 144 128 144 16
WIRE 144 128 128 128
WIRE 224 128 144 128
WIRE 272 128 224 128
WIRE 368 128 368 -32
WIRE 368 128 352 128
WIRE 384 128 368 128
WIRE 480 128 464 128
WIRE 496 128 480 128
WIRE 48 144 16 144
WIRE 64 144 48 144
WIRE -112 160 -112 128
WIRE 480 160 480 128
WIRE 528 160 528 144
WIRE 96 176 96 160
WIRE 16 192 16 144
WIRE -48 208 -48 192
WIRE 672 208 672 192
WIRE 480 224 480 208
WIRE 480 240 480 224
WIRE 16 288 16 272
FLAG 96 176 0
FLAG -112 160 0
FLAG -112 16 3v3
FLAG 96 80 3v3
FLAG -48 208 0
FLAG 16 288 0
FLAG 528 160 0
FLAG 528 64 3v3
FLAG 480 240 0
FLAG 832 32 0
FLAG 672 208 0
FLAG 224 128 Vgain
FLAG 48 144 B
FLAG 608 112 A
SYMBOL Opamps\\LTC2054 96 128 R0
SYMATTR InstName U1
SYMBOL voltage 16 176 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value SINE(0 1m {Freq})
SYMBOL res -64 96 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res 128 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 62k
SYMBOL voltage -112 32 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 3.3
SYMBOL Opamps\\LTC2054 528 112 R0
SYMATTR InstName U2
SYMBOL res 368 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {R0}
SYMBOL res 480 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {R0}
SYMBOL cap 464 160 R0
SYMATTR InstName C1
SYMATTR Value 0.1µF
SYMBOL res 688 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R1}
SYMBOL res 704 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value {R0}
SYMBOL cap 544 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 0.1µF
SYMBOL res 656 96 R0
SYMATTR InstName R7
SYMATTR Value 1k
TEXT -68 312 Left 2 !.param t0=10\n.tran 0 {t0+25/freq} {t0}\n.step dec param freq 0.1 500 5\n.save V(a) V(b)\n.option plotwinsize=0 numdgt=15
TEXT 336 312 Left 2 !.param R0 1Meg\n.param R1 590k
TEXT 784 176 Left 2 !.measure Aavg avg V(a)\n.measure Bavg avg V(b)\n.measure Are avg (V(a)-Aavg)*cos(360*time*Freq)\n.measure Aim avg -(V(a)-Aavg)*sin(360*time*Freq)\n.measure Bre avg (V(b)-Bavg)*cos(360*time*Freq)\n.measure Bim avg -(V(b)-Bavg)*sin(360*time*Freq)\n.measure GainMag param 20*log10(hypot(Are,Aim) / hypot(Bre,Bim))\n.measure GainPhi param mod(atan2(Aim, Are) - atan2(Bim, Bre)+180,360)-180
